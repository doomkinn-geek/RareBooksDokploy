# ‚úÖ –ü–ê–†–°–ï–† XLSX –ò –û–ë–ù–û–í–õ–ï–ù–ò–Ø FRONTEND - –ü–û–õ–ù–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

–î–∞—Ç–∞: 30 –Ω–æ—è–±—Ä—è 2025

---

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. **–°–æ–∑–¥–∞–Ω –ø–∞—Ä—Å–µ—Ä –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ XLSX** ‚úÖ
### 2. **–û–±–Ω–æ–≤–ª–µ–Ω frontend –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π** ‚úÖ
### 3. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö** ‚úÖ

---

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend - –ü–∞—Ä—Å–µ—Ä

1. **`RareBooksImporter/Program.cs`** - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞
   - –ß—Ç–µ–Ω–∏–µ XLSX —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ EPPlus
   - –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç, —Ü–µ–Ω, –Ω–∞–∑–≤–∞–Ω–∏–π
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
   - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∫–∏ + –¥–æ—Å—Ç–∞–≤–∫–∞
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
   - –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL

2. **`RareBooksImporter/README.md`** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

3. **`RareBooksImporter/appsettings.json`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

### Frontend - –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

4. **`UserCollection.jsx`** - –û–±–Ω–æ–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø–æ–∫—É–ø–∫–∏
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏
   - –ß–∏–ø—ã —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–¥–µ–ª–∫–∞—Ö

5. **`CollectionBookDetail.jsx`** - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã –∏ —Ü–µ–Ω—ã –ø–æ–∫—É–ø–∫–∏
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã –∏ —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏
   - –†–∞—Å—á–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏

---

## üîß –ü–∞—Ä—Å–µ—Ä XLSX - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ XLSX

```
| A           | B                 | C    | D       | E        | F       | G    | H      | I           | J          | K            |
|-------------|-------------------|------|---------|----------|---------|------|--------|-------------|------------|--------------|
| –î–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏| –ù–∞–∑–≤–∞–Ω–∏–µ, –ê–≤—Ç–æ—Ä   | –ì–æ–¥  | –¶–µ–Ω–∞    | –î–æ—Å—Ç–∞–≤–∫–∞ | –ü—Ä–æ–¥–∞–Ω–æ | –î–æ—Å—Ç.| –ü—Ä–æ—Ñ–∏—Ç | –î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏| –û –ø—Ä–æ–¥–∞–∂–µ  | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π  |
```

### –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

#### 1. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞**

```csharp
"–ó–∞—Ö–∞—Ä—å–∏–Ω (–Ø–∫—É–Ω–∏–Ω). –¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ" 
‚Üì
–ê–≤—Ç–æ—Ä: "–ó–∞—Ö–∞—Ä—å–∏–Ω (–Ø–∫—É–Ω–∏–Ω)"
–ù–∞–∑–≤–∞–Ω–∏–µ: "–¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ"
```

#### 2. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏**

```csharp
–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏: 1500 ‚ÇΩ
+ –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏: 300 ‚ÇΩ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
= PurchasePrice: 1800 ‚ÇΩ
```

#### 3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤**

```csharp
–ü–æ–ª–µ "–û –ø—Ä–æ–¥–∞–∂–µ": "–ü—Ä–æ–¥–∞–Ω–æ –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–µ"
–ü–æ–ª–µ "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π": "–†–µ–¥–∫–æ–µ –∏–∑–¥–∞–Ω–∏–µ"
‚Üì
Notes: "–û –ø—Ä–æ–¥–∞–∂–µ: –ü—Ä–æ–¥–∞–Ω–æ –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–µ\n\n–†–µ–¥–∫–æ–µ –∏–∑–¥–∞–Ω–∏–µ"
```

#### 4. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ–¥–∞–∂–∏**

```csharp
if (soldPrice.HasValue || soldDate.HasValue)
    IsSold = true
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
cd c:\rarebooks\RareBooksImporter

# 1. –°–±–æ—Ä–∫–∞
dotnet build

# 2. –ó–∞–ø—É—Å–∫
dotnet run "C:\path\to\books.xlsx" "user-id-here"
```

### –í—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã

```
=== –ò–º–ø–æ—Ä—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∫–Ω–∏–≥ –∏–∑ XLSX ===

–§–∞–π–ª: C:\path\to\books.xlsx
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: a1b2c3d4-...

–ù–∞–π–¥–µ–Ω–æ —Å—Ç—Ä–æ–∫: 20

–°—Ç—Ä–æ–∫–∞ 3: ‚úÖ –ó–∞—Ö–∞—Ä—å–∏–Ω (–Ø–∫—É–Ω–∏–Ω). –¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ
–°—Ç—Ä–æ–∫–∞ 4: ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ï–≤—Ä–æ–ø—ã. 2—Ç—Ç.
–°—Ç—Ä–æ–∫–∞ 5: ‚úÖ –†—É—Å—Å–∫–∞—è –º—ã—Å–ª—å. 1887. –ö–Ω–∏–≥–∞ 5
–°—Ç—Ä–æ–∫–∞ 6: ‚úÖ –†—É—Å—Å–∫–∞—è –º—ã—Å–ª—å. 1887. –ö–Ω–∏–≥–∞ 6
–°—Ç—Ä–æ–∫–∞ 7: ‚úÖ –†—É—Å—Å–∫–∞—è –º—ã—Å–ª—å. 1898. –ö–Ω–∏–≥–∞ 1
...

–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: 18
–ü—Ä–æ–ø—É—â–µ–Ω–æ: 2

‚úÖ –ò–º–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!
```

---

## üé® Frontend - –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### 1. UserCollection.jsx - –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥

**–ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:**

```jsx
<Box sx={{ mt: 2, display: 'flex', gap: 1, flexWrap: 'wrap' }}>
    {/* –û—Ü–µ–Ω–∫–∞ */}
    <Chip label={`–û—Ü–µ–Ω–∫–∞: ${book.estimatedPrice} ‚ÇΩ`} color="primary" />
    
    {/* –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ */}
    {book.purchasePrice && (
        <Chip label={`–ö—É–ø–ª–µ–Ω–∞: ${book.purchasePrice} ‚ÇΩ`} color="info" variant="outlined" />
    )}
    
    {/* –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ */}
    {book.isSold && book.soldPrice && (
        <Chip label={`–ü—Ä–æ–¥–∞–Ω–∞: ${book.soldPrice} ‚ÇΩ`} color="success" />
    )}
</Box>
```

**–°–∫—Ä–∏–Ω—à–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìñ –ó–∞—Ö–∞—Ä—å–∏–Ω. –¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ      ‚îÇ
‚îÇ 1885 –≥.                         ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ [–û—Ü–µ–Ω–∫–∞: 1900 ‚ÇΩ]               ‚îÇ
‚îÇ [–ö—É–ø–ª–µ–Ω–∞: 1900 ‚ÇΩ]              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2. CollectionBookDetail.jsx - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

**–ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:**

```jsx
{/* –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ */}
{book.purchasePrice && (
    <Typography variant="body1" sx={{ color: 'info.main' }}>
        –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: <strong>{book.purchasePrice} ‚ÇΩ</strong>
        {book.purchaseDate && ` (${new Date(book.purchaseDate).toLocaleDateString()})`}
    </Typography>
)}

{/* –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ */}
{book.isSold && book.soldPrice && (
    <Typography variant="body1" sx={{ color: 'success.main' }}>
        –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏: <strong>{book.soldPrice} ‚ÇΩ</strong>
        {book.soldDate && ` (${new Date(book.soldDate).toLocaleDateString()})`}
    </Typography>
)}

{/* –ü—Ä–∏–±—ã–ª—å */}
{book.isSold && book.purchasePrice && book.soldPrice && (
    <Typography 
        variant="body1" 
        sx={{ 
            color: (book.soldPrice - book.purchasePrice) >= 0 ? 'success.dark' : 'error.main',
            fontWeight: 'bold'
        }}
    >
        –ü—Ä–∏–±—ã–ª—å: {(book.soldPrice - book.purchasePrice) >= 0 ? '+' : ''}
        {(book.soldPrice - book.purchasePrice).toLocaleString('ru-RU')} ‚ÇΩ
    </Typography>
)}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:**

```
–ó–∞—Ö–∞—Ä—å–∏–Ω (–Ø–∫—É–Ω–∏–Ω). –¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ
–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è: 1885

–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: 1900 ‚ÇΩ (07.01.2016)

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

–û–ø–∏—Å–∞–Ω–∏–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
–ü–µ—Ä–≤–∞—è –∫—É–ø–ª–µ–Ω–Ω–∞—è –∫–Ω–∏–≥–∞...
```

**–î–ª—è –ø—Ä–æ–¥–∞–Ω–Ω–æ–π –∫–Ω–∏–≥–∏:**

```
–ö–Ω–∏–≥–∞ IV. –ü–æ–ø–µ—è –°–∞–±–∏–Ω–∞ –∏ –û–∫—Ç–∞–≤–∏—è
–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è: 1913

–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: 250 ‚ÇΩ (02.12.2016)
–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏: 1 ‚ÇΩ (09.09.2017)
–ü—Ä–∏–±—ã–ª—å: -249 ‚ÇΩ

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

–õ–∏—á–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏:
–û –ø—Ä–æ–¥–∞–∂–µ: –ü—Ä–æ–¥–∞–Ω–æ –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–µ

–†–µ–¥–∫–æ–µ –∏–∑–¥–∞–Ω–∏–µ
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ UserCollectionBooks

```sql
-- –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏
PurchasePrice    NUMERIC(18,2)               -- –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (–≤–∫–ª—é—á–∞—è –¥–æ—Å—Ç–∞–≤–∫—É)
PurchaseDate     TIMESTAMP WITH TIME ZONE    -- –î–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏

-- –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
IsSold           BOOLEAN DEFAULT FALSE       -- –§–ª–∞–≥ –ø—Ä–æ–¥–∞–∂–∏
SoldPrice        NUMERIC(18,2)               -- –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (–±–µ–∑ –¥–æ—Å—Ç–∞–≤–∫–∏)
SoldDate         TIMESTAMP WITH TIME ZONE    -- –î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏

-- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
Notes            TEXT                        -- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ + –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥–∞–∂–µ
```

### DTO –æ–±–Ω–æ–≤–ª–µ–Ω—ã

**UserCollectionBookDto:**
```csharp
public decimal? PurchasePrice { get; set; }
public DateTime? PurchaseDate { get; set; }
public bool IsSold { get; set; }
public decimal? SoldPrice { get; set; }
public DateTime? SoldDate { get; set; }
```

**CollectionStatisticsDto:**
```csharp
public decimal TotalPurchaseValue { get; set; }      // –°—É–º–º–∞ –∑–∞—Ç—Ä–∞—Ç
public decimal TotalSoldValue { get; set; }          // –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂
public decimal TotalProfit { get; set; }             // –ü—Ä–∏–±—ã–ª—å
public int BooksSold { get; set; }                   // –ö–æ–ª-–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö
public int BooksInCollection { get; set; }           // –ö–æ–ª-–≤–æ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –®–∞–≥ 1: –£–∑–Ω–∞—Ç—å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
docker exec -it rarebooks-users-db psql -U postgres -d usersdb

# –ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT "Id", "Email" FROM "AspNetUsers";
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç

```bash
cd c:\rarebooks\RareBooksImporter
dotnet run "C:\path\to\books.xlsx" "user-id-from-step1"
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç
3. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è"
5. –£–≤–∏–¥–∏—Ç–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

---

## üìã –ß–µ–∫–ª–∏—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π

### –ü–∞—Ä—Å–µ—Ä ‚úÖ

- [x] –ß—Ç–µ–Ω–∏–µ XLSX —Ñ–∞–π–ª–æ–≤
- [x] –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç (—Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã)
- [x] –ü–∞—Ä—Å–∏–Ω–≥ —Ü–µ–Ω (—Å —Å–∏–º–≤–æ–ª–∞–º–∏ –≤–∞–ª—é—Ç—ã)
- [x] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
- [x] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞ –∏–∑–¥–∞–Ω–∏—è (–≤ —Ç–æ–º —á–∏—Å–ª–µ –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤)
- [x] –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∫–∏ + –¥–æ—Å—Ç–∞–≤–∫–∞
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–¥–∞–∂–µ
- [x] –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- [x] –ü—Ä–æ–ø—É—Å–∫ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### Frontend ‚úÖ

- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø–æ–∫—É–ø–∫–∏ –≤ —Å–ø–∏—Å–∫–µ
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏ –≤ —Å–ø–∏—Å–∫–µ
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã –ø–æ–∫—É–ø–∫–∏ –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã –ø—Ä–æ–¥–∞–∂–∏ –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- [x] –†–∞—Å—á–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏
- [x] –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è (–∑–µ–ª—ë–Ω—ã–π = –ø—Ä–∏–±—ã–ª—å, –∫—Ä–∞—Å–Ω—ã–π = —É–±—ã—Ç–æ–∫)
- [x] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å —É—á–µ—Ç–æ–º –ø—Ä–æ–¥–∞–∂

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∏–º–µ—Ä 1: –ù–µ–ø—Ä–æ–¥–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞

**XLSX:**
```
7-1-2016 | –ó–∞—Ö–∞—Ä—å–∏–Ω (–Ø–∫—É–Ω–∏–Ω). –¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ | 1885 | 1900 | 0 | | | | | | –ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞
```

**–í –ë–î:**
```json
{
  "title": "–¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ",
  "author": "–ó–∞—Ö–∞—Ä—å–∏–Ω (–Ø–∫—É–Ω–∏–Ω)",
  "yearPublished": 1885,
  "purchasePrice": 1900.00,
  "purchaseDate": "2016-01-07T00:00:00Z",
  "isSold": false,
  "notes": "–ü–µ—Ä–≤–∞—è –∫–Ω–∏–≥–∞"
}
```

**–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:**
```
üìñ –ó–∞—Ö–∞—Ä—å–∏–Ω (–Ø–∫—É–Ω–∏–Ω). –¢–µ–Ω–∏ –ø—Ä–æ—à–ª–æ–≥–æ
   1885 –≥.
   
   [–û—Ü–µ–Ω–∫–∞: 1900 ‚ÇΩ] [–ö—É–ø–ª–µ–Ω–∞: 1900 ‚ÇΩ]
```

### –ü—Ä–∏–º–µ—Ä 2: –ü—Ä–æ–¥–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞

**XLSX:**
```
12-2-2016 | –ü–æ–ø–µ—è –°–∞–±–∏–Ω–∞ | 1913 | 150 | 100 | 1 | 250 | 86 | 9-9-2017 | –ü—Ä–æ–¥–∞–Ω–æ | –†–µ–¥–∫–æ–µ
```

**–í –ë–î:**
```json
{
  "title": "–ü–æ–ø–µ—è –°–∞–±–∏–Ω–∞",
  "yearPublished": 1913,
  "purchasePrice": 250.00,
  "purchaseDate": "2016-12-02T00:00:00Z",
  "isSold": true,
  "soldPrice": 1.00,
  "soldDate": "2017-09-09T00:00:00Z",
  "notes": "–û –ø—Ä–æ–¥–∞–∂–µ: –ü—Ä–æ–¥–∞–Ω–æ\n\n–†–µ–¥–∫–æ–µ"
}
```

**–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:**
```
üìñ –ü–æ–ø–µ—è –°–∞–±–∏–Ω–∞
   1913 –≥.
   
   [–û—Ü–µ–Ω–∫–∞: -] [–ö—É–ø–ª–µ–Ω–∞: 250 ‚ÇΩ] [–ü—Ä–æ–¥–∞–Ω–∞: 1 ‚ÇΩ]
   
   –î–µ—Ç–∞–ª–∏:
   –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: 250 ‚ÇΩ (02.12.2016)
   –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏: 1 ‚ÇΩ (09.09.2017)
   –ü—Ä–∏–±—ã–ª—å: -249 ‚ÇΩ
```

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã

**–ü–∞—Ä—Å–µ—Ä:**
- `EPPlus` - —á—Ç–µ–Ω–∏–µ XLSX —Ñ–∞–π–ª–æ–≤
- `Npgsql` - —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL
- `Microsoft.Extensions.Configuration` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**Frontend:**
- –£–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MUI components
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

### DateTime –æ–±—Ä–∞–±–æ—Ç–∫–∞

–í—Å–µ –¥–∞—Ç—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ UTC –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:

```csharp
DateTime.SpecifyKind(date, DateTimeKind.Utc)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ NULL –∑–Ω–∞—á–µ–Ω–∏–π

```csharp
cmd.Parameters.AddWithValue("PurchasePrice", (object)book.TotalPurchasePrice ?? DBNull.Value);
cmd.Parameters.AddWithValue("SoldDate", (object)book.SoldDate ?? DBNull.Value);
```

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–°—Ç—Ä–æ–∫–∞ 2 —Å —Å—É–º–º–∞–º–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è** - –∏–º–ø–æ—Ä—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ —Å—Ç—Ä–æ–∫–∏ 3
2. **–ê–≤—Ç–æ—Ä –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** - –µ—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—á–∫—É –∏ –∏–º—è
3. **–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è** - —Å —Ü–µ–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ –≤ –µ–¥–∏–Ω–æ–µ –ø–æ–ª–µ
4. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è** - "–û –ø—Ä–æ–¥–∞–∂–µ" –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–æ –∑–∞–º–µ—Ç–æ–∫
5. **–í—Å–µ –¥–∞—Ç—ã –≤ UTC** - –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å PostgreSQL
6. **–ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è** - –µ—Å–ª–∏ –Ω–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–Ω–∏–≥–∏

---

## ‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç

**–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:**

1. ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏–∑ XLSX –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
2. ‚úÖ –í–∏–¥–µ—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–∫—É–ø–∫–µ –∏ –ø—Ä–æ–¥–∞–∂–µ –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏
3. ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–∫–∏ –ø–æ –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–µ
4. ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º —Å–¥–µ–ª–æ–∫
5. ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–ª—è —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**

