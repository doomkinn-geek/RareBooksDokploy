---
name: React Native –£–ª—É—á—à–µ–Ω–∏—è
overview: "–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–µ–∫—Å—Ç/–∞—É–¥–∏–æ/—Ñ–æ—Ç–æ), —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏, QR-–∫–æ–¥—ã, push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —Å—Ç–∞—Ç—É—Å—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ UI —É–ª—É—á—à–µ–Ω–∏—è"
todos:
  - id: text-messages
    content: –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–∏–∫–æ–Ω–∫–∏, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)
    status: completed
  - id: replace-audio
    content: –ó–∞–º–µ–Ω–∏—Ç—å react-native-audio-recorder-player –Ω–∞ expo-av
    status: completed
  - id: audio-messages
    content: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –∏ –æ—Ç–ø—Ä–∞–≤–∫—É –∞—É–¥–∏–æ —Å–æ–æ–±—â–µ–Ω–∏–π
    status: completed
  - id: image-messages
    content: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞—Ö–≤–∞—Ç, —Å–∂–∞—Ç–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    status: completed
  - id: message-statuses
    content: –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
    status: completed
  - id: contacts-integration
    content: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—É—é –∫–Ω–∏–≥—É (–∏–º–µ–Ω–∞, –≤—ã–±–æ—Ä –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤)
    status: completed
  - id: qr-codes
    content: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å QR-–∫–æ–¥—ã (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)
    status: completed
  - id: push-notifications
    content: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è Firebase
    status: completed
  - id: ui-improvements
    content: –î–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫–∏, –∞–≤–∞—Ç–∞—Ä—ã –∏ —É–ª—É—á—à–∏—Ç—å UI
    status: completed
  - id: final-build
    content: –°–æ–±—Ä–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π standalone APK
    status: completed
---

# –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## 1. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (–ü–†–ò–û–†–ò–¢–ï–¢)

### 1.1 –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ [`src/screens/ChatScreen.tsx`](src/screens/ChatScreen.tsx) –∏ [`src/store/slices/messagesSlice.ts`](src/store/slices/messagesSlice.ts)**–ß—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å:**

- –î–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∫–Ω–æ–ø–∫–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å –ø–æ–≤—Ç–æ—Ä–æ–º –æ—Ç–ø—Ä–∞–≤–∫–∏

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/presentation/providers/messages_provider.dart`](lib/presentation/providers/messages_provider.dart) —Å—Ç—Ä–æ–∫–∏ 289-378

### 1.2 –ê—É–¥–∏–æ —Å–æ–æ–±—â–µ–Ω–∏—è

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã ([`src/components/AudioRecorder.tsx`](src/components/AudioRecorder.tsx)), –Ω–æ –ù–ï –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ ChatScreen**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**

1. **–ó–∞–º–µ–Ω–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É:** –£–¥–∞–ª–∏—Ç—å `react-native-audio-recorder-player`, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `expo-av`
   ```bash
                  npm uninstall react-native-audio-recorder-player
                  npm install expo-av --legacy-peer-deps
                  npx expo install expo-av
   ```




2. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:** `src/components/AudioRecorderExpo.tsx`

- –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ `Audio.Recording` –∏–∑ expo-av
- –§–æ—Ä–º–∞—Ç: AAC, –±–∏—Ç—Ä–µ–π—Ç 128kbps
- –†–µ—Ñ–µ—Ä–µ–Ω—Å: Flutter –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `AudioRecorder` —Å `AudioEncoder.aacLc`

3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ ChatScreen:**

- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –≤ input container
- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ = –∑–∞–ø–∏—Å—å, –æ—Ç–ø—É—Å—Ç–∏—Ç—å = –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
- –°–≤–∞–π–ø –≤–ª–µ–≤–æ = –æ—Ç–º–µ–Ω–∏—Ç—å

4. **API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:**

- –°–æ–∑–¥–∞—Ç—å `messagesApi.sendAudioMessage(token, chatId, audioFile)`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FormData —Å multipart/form-data
- Endpoint: `POST /api/messages/audio`
- –†–µ—Ñ–µ—Ä–µ–Ω—Å: Flutter [`lib/data/datasources/api_datasource.dart`](lib/data/datasources/api_datasource.dart) —Å—Ç—Ä–æ–∫–∏ 158-176

### 1.3 –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `ImagePicker` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –ù–ï –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
   ```bash
                  npm install react-native-image-picker --legacy-peer-deps
                  npm install react-native-image-resizer --legacy-peer-deps
   ```




2. **–°–æ–∑–¥–∞—Ç—å `src/services/imageService.ts`:**

- –§—É–Ω–∫—Ü–∏—è `capturePhoto()` - –∫–∞–º–µ—Ä–∞
- –§—É–Ω–∫—Ü–∏—è `pickPhoto()` - –≥–∞–ª–µ—Ä–µ—è
- –§—É–Ω–∫—Ü–∏—è `compressImage(uri)` - —Å–∂–∞—Ç–∏–µ –¥–æ max 1920px, quality 0.8

3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ ChatScreen:**

- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É —Å–∫—Ä–µ–ø–∫–∏/–∫–∞–º–µ—Ä—ã
- –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: "–ö–∞–º–µ—Ä–∞" | "–ì–∞–ª–µ—Ä–µ—è"
- –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ - —Å–∂–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

4. **API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:**

- `messagesApi.sendImageMessage(token, chatId, imageFile)`
- FormData multipart/form-data
- Endpoint: `POST /api/messages/image` (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–∞ backend)

## 2. –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–π –∫–Ω–∏–≥–∏

### 2.1 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω –∏–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–π –∫–Ω–∏–≥–∏

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/presentation/providers/contacts_names_provider.dart`](lib/presentation/providers/contacts_names_provider.dart)**–ü–ª–∞–Ω:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É:**
   ```bash
                  npm install react-native-contacts --legacy-peer-deps
                  npx pod-install
   ```




2. **–°–æ–∑–¥–∞—Ç—å `src/services/contactsService.ts`:**

- `requestPermission()` - –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- `getAllContacts()` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã
- `syncContactsWithServer(token)` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ö—ç—à–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- `buildContactsMapping(registeredUsers)` - userId ‚Üí displayName

3. **–°–æ–∑–¥–∞—Ç—å Redux slice `src/store/slices/contactsSlice.ts`:**

- State: `{ mapping: { [userId: string]: string } }`
- Thunk: `syncContacts(token)`
- Selector: `selectContactName(userId)`

4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å:**

- –í `ChatsListScreen`: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–º–µ–Ω–∞ –∏–∑ mapping
- –í `ChatScreen`: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–º–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π –∏–∑ mapping
- –í—ã–∑–≤–∞—Ç—å `syncContacts()` –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

### 2.2 –í—ã–±–æ—Ä –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —á–∞—Ç–∞

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/presentation/screens/new_chat_screen.dart`](lib/presentation/screens/new_chat_screen.dart)**–ü–ª–∞–Ω:**

1. **–û–±–Ω–æ–≤–∏—Ç—å `NewChatScreen`:**

- –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–π –∫–Ω–∏–≥–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∏–º–µ–Ω–∏
- –ü—Ä–∏ –∫–ª–∏–∫–µ - —Å–æ–∑–¥–∞—Ç—å —á–∞—Ç —á–µ—Ä–µ–∑ `POST /api/chats/create-or-get`

2. **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

- Search bar –≤–≤–µ—Ä—Ö—É
- FlatList —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏ (–ø–µ—Ä–≤–∞—è –±—É–∫–≤–∞ –∏–º–µ–Ω–∏)
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

## 3. QR –∫–æ–¥—ã –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π

### 3.1 –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR –∫–æ–¥–∞ (Auth Screen)

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/presentation/screens/auth_screen.dart`](lib/presentation/screens/auth_screen.dart) —Å—Ç—Ä–æ–∫–∏ 39-82**–ü–ª–∞–Ω:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É:**
   ```bash
                  npm install react-native-camera --legacy-peer-deps
   ```




2. **–û–±–Ω–æ–≤–∏—Ç—å `AuthScreen`:**

- –î–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫—É QR Scanner —Ä—è–¥–æ–º —Å –ø–æ–ª–µ–º invite code
- –ü—Ä–∏ –∫–ª–∏–∫–µ - –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Å–∫–∞–Ω–µ—Ä
- –ü–∞—Ä—Å–∏—Ç—å URL `maymessenger://invite?code=XXXXX`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ invite code

### 3.2 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ QR –∫–æ–¥–∞ (Settings)

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/presentation/widgets/qr_invite_dialog.dart`](lib/presentation/widgets/qr_invite_dialog.dart)**–ü–ª–∞–Ω:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É:**
   ```bash
                  npm install react-native-qrcode-svg --legacy-peer-deps
   ```




2. **–°–æ–∑–¥–∞—Ç—å `src/components/QRInviteDialog.tsx`:**

- –ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥ —Å `maymessenger://invite?code=${inviteCode}`
- –ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥"
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" (Share API)

3. **–û–±–Ω–æ–≤–∏—Ç—å `SettingsScreen`:**

- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞"
- –ü—Ä–∏ –∫–ª–∏–∫–µ - —Å–æ–∑–¥–∞—Ç—å invite code —á–µ—Ä–µ–∑ API
- –ü–æ–∫–∞–∑–∞—Ç—å QRInviteDialog

4. **API:**

- `POST /api/invite/create` ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ code, expiresAt }`

## 4. Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è Firebase

### 4.1 –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è FCM —Ç–æ–∫–µ–Ω–∞

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/core/services/fcm_service.dart`](lib/core/services/fcm_service.dart)**–ü–ª–∞–Ω:**

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**

- Firebase —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (google-services.json —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –ü–∞–∫–µ—Ç `@react-native-firebase/messaging` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

2. **–°–æ–∑–¥–∞—Ç—å `src/services/fcmService.ts`:**

- `requestPermission()` - –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- `getToken()` - –ø–æ–ª—É—á–∏—Ç—å FCM —Ç–æ–∫–µ–Ω
- `registerToken(token, jwtToken)` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- Endpoint: `POST /api/notifications/register-token`

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

- Foreground: –ø–æ–∫–∞–∑–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- Background/Quit: –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ Firebase onBackgroundMessage
- OnTap: –æ—Ç–∫—Ä—ã—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç

4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**

- –í—ã–∑–≤–∞—Ç—å `registerToken()` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞
- –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ `onTokenRefresh`

### 4.2 –õ–æ–∫–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ü–ª–∞–Ω:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:**
   ```bash
                  npm install @notifee/react-native --legacy-peer-deps
   ```




2. **–°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª –¥–ª—è Android:**

- Channel ID: `messages_channel`
- Importance: HIGH
- –ó–≤—É–∫, –≤–∏–±—Ä–∞—Ü–∏—è

## 5. –°—Ç–∞—Ç—É—Å—ã —Å–æ–æ–±—â–µ–Ω–∏–π (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ/–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ/–ø—Ä–æ—á–∏—Ç–∞–Ω–æ)

### 5.1 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/presentation/widgets/message_bubble.dart`](lib/presentation/widgets/message_bubble.dart) —Å—Ç—Ä–æ–∫–∏ 162-195**–ü–ª–∞–Ω:**

1. **–û–±–Ω–æ–≤–∏—Ç—å `AnimatedMessageBubble.tsx`:**

- –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `renderStatusIcon(status)`
- Sending: `<ActivityIndicator size="small" />`
- Sent: `<Icon name="check" />` (1 –≥–∞–ª–æ—á–∫–∞ —Å–µ—Ä–∞—è)
- Delivered: `<Icon name="check-all" />` (2 –≥–∞–ª–æ—á–∫–∏ —Å–µ—Ä—ã–µ)
- Read: `<Icon name="check-all" color="green" />` (2 –≥–∞–ª–æ—á–∫–∏ –∑–µ–ª–µ–Ω—ã–µ)
- Failed: `<Icon name="alert-circle" color="red" />`

2. **–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–≤–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π**

### 5.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —á–µ—Ä–µ–∑ SignalR

**–†–µ—Ñ–µ—Ä–µ–Ω—Å:** Flutter [`lib/data/datasources/signalr_service.dart`](lib/data/datasources/signalr_service.dart)**–ü–ª–∞–Ω:**

1. **–û–±–Ω–æ–≤–∏—Ç—å `src/services/signalrService.ts`:**

- –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏–µ `"MessageStatusChanged"`
- Payload: `{ messageId, status }`
- Dispatch `updateMessageStatus({ messageId, status })`

2. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "–ø—Ä–æ—á–∏—Ç–∞–Ω–æ":**

- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ ChatScreen - –æ—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
- SignalR: `connection.invoke("MarkAsRead", messageId, chatId)`
- REST fallback: `POST /api/messages/mark-read` —Å –º–∞—Å—Å–∏–≤–æ–º ID

## 6. UI —É–ª—É—á—à–µ–Ω–∏—è

### 6.1 –ò–∫–æ–Ω–∫–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ü–ª–∞–Ω:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∫–æ–Ω–∫–∏:**

- –£–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `react-native-vector-icons`
- –î–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫–∏ –≤ navigation tabs, –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

2. **–ê–≤–∞—Ç–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**

- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–µ—Ä–≤—É—é –±—É–∫–≤—É displayName
- –¶–≤–µ—Ç —Ñ–æ–Ω–∞ = hash(userId) % 10 –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: `src/components/Avatar.tsx`

3. **–ü—Ä–µ–≤—å—é —á–∞—Ç–æ–≤:**

- –ü–æ–∫–∞–∑–∞—Ç—å –∞–≤–∞—Ç–∞—Ä —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ —Å–ª–µ–≤–∞
- –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—Ç–µ–∫—Å—Ç –∏–ª–∏ "üé§ –ê—É–¥–∏–æ" –∏–ª–∏ "üì∑ –§–æ—Ç–æ")
- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- Badge —Å –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏

### 6.2 –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

- [`src/screens/ChatsListScreen.tsx`](src/screens/ChatsListScreen.tsx) - –¥–æ–±–∞–≤–∏—Ç—å –∞–≤–∞—Ç–∞—Ä—ã
- [`src/screens/ChatScreen.tsx`](src/screens/ChatScreen.tsx) - –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –∞—É–¥–∏–æ/—Ñ–æ—Ç–æ
- [`src/navigation/MainNavigator.tsx`](src/navigation/MainNavigator.tsx) - –∏–∫–æ–Ω–∫–∏ –≤ tabs

## 7. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ build.gradle

**–¶–µ–ª—å:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å–±–æ—Ä–∫–∏ Release APK —Å react-native-audio-recorder-player**–ü–ª–∞–Ω:**

1. –ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã –Ω–∞ expo-av, —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ `android/app/build.gradle`
2. –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à: `cd android && ./gradlew clean`
3. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å: `./gradlew assembleRelease`

## –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (–∫—Ä–∏—Ç–∏—á–Ω–æ)

1. –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è + –∏–∫–æ–Ω–∫–∏
2. –ó–∞–º–µ–Ω–∏—Ç—å audio –±–∏–±–ª–∏–æ—Ç–µ–∫—É –Ω–∞ expo-av
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞—É–¥–∏–æ –∑–∞–ø–∏—Å—å –∏ –æ—Ç–ø—Ä–∞–≤–∫—É
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ç–æ —Å —Å–∂–∞—Ç–∏–µ–º

### –≠—Ç–∞–ø 2: UI –∏ —Å—Ç–∞—Ç—É—Å—ã

5. –î–æ–±–∞–≤–∏—Ç—å –∞–≤–∞—Ç–∞—Ä—ã –∏ –∏–∫–æ–Ω–∫–∏
6. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
7. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã —á–µ—Ä–µ–∑ SignalR

### –≠—Ç–∞–ø 3: –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ QR

8. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–π –∫–Ω–∏–≥–æ–π
9. –í—ã–±–æ—Ä –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —á–∞—Ç–∞
10. QR-–∫–æ–¥—ã (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)

### –≠—Ç–∞–ø 4: Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

11. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è FCM —Ç–æ–∫–µ–Ω–∞
12. –û–±—Ä–∞–±–æ—Ç–∫–∞ foreground/background —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –≠—Ç–∞–ø 5: –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞

13. –°–æ–±—Ä–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π APK
14. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# Audio (–∑–∞–º–µ–Ω–∞)
npm uninstall react-native-audio-recorder-player
npm install expo-av --legacy-peer-deps

# Images
npm install react-native-image-picker react-native-image-resizer --legacy-peer-deps

# Contacts
npm install react-native-contacts --legacy-peer-deps

# QR
npm install react-native-camera react-native-qrcode-svg --legacy-peer-deps

# Notifications
npm install @notifee/react-native --legacy-peer-deps
```



## –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**

- `src/components/AudioRecorderExpo.tsx`
- `src/components/Avatar.tsx`
- `src/components/QRInviteDialog.tsx`
- `src/components/QRScanner.tsx`
- `src/services/contactsService.ts`
- `src/services/imageService.ts`
- `src/services/fcmService.ts`
- `src/store/slices/contactsSlice.ts`

**–ò–∑–º–µ–Ω–∏—Ç—å:**

- `src/screens/ChatScreen.tsx` - –¥–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏–æ/—Ñ–æ—Ç–æ –∫–Ω–æ–ø–∫–∏
- `src/screens/AuthScreen.tsx` - –¥–æ–±–∞–≤–∏—Ç—å QR Scanner