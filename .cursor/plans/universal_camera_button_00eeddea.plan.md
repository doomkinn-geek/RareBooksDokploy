---
name: Universal Camera Button
overview: "ะะฑัะตะดะธะฝะธัั ะฟัะฝะบัั ะผะตะฝั \"ะะฐะผะตัะฐ\", \"ะะฐะปะตัะตั\" ะธ \"ะะธะดะตะพ\" ะฒ ะพะดะธะฝ ัะฝะธะฒะตััะฐะปัะฝัะน ะฒะธะดะถะตั ะบะฐะผะตัั: tap ะดะปั ัะพัะพ, long-press ะดะปั ะทะฐะฟะธัะธ ะฒะธะดะตะพ, ั ะฒะพะทะผะพะถะฝะพัััั ะฒัะฑะพัะฐ ะธะท ะณะฐะปะตัะตะธ."
todos:
  - id: camera-widget
    content: ะกะพะทะดะฐัั ะฒะธะดะถะตั CameraButton ั tap/long-press ะพะฑัะฐะฑะพัะบะพะน ะธ bottom sheet
    status: completed
  - id: record-video
    content: ะะพะฑะฐะฒะธัั ะผะตัะพะด _recordVideoFromCamera() ะดะปั ะทะฐะฟะธัะธ ะฒะธะดะตะพ ั ะบะฐะผะตัั
    status: completed
  - id: gallery-picker
    content: ะะฑะฝะพะฒะธัั ะฒัะฑะพั ะธะท ะณะฐะปะตัะตะธ ะดะปั ะฟะพะดะดะตัะถะบะธ ัะพัะพ ะธ ะฒะธะดะตะพ ะพะดะฝะพะฒัะตะผะตะฝะฝะพ
    status: completed
  - id: update-ui
    content: ะะฐะผะตะฝะธัั PopupMenuButton ะฝะฐ ะฝะพะฒัะน CameraButton + ะบะฝะพะฟะบั ัะฐะนะปะฐ
    status: completed
---

# ะฃะฝะธะฒะตััะฐะปัะฝะฐั ะบะฝะพะฟะบะฐ ะบะฐะผะตัั ะดะปั ะผะตะดะธะฐ-ะบะพะฝัะตะฝัะฐ

## ะขะตะบััะตะต ัะพััะพัะฝะธะต

ะกะตะนัะฐั ะฒ [message_input.dart](d:\_SOURCES\source\RareBooksServicePublic\_may_messenger_mobile_app\lib\presentation\widgets\message_input.dart) ะตััั `PopupMenuButton` ั 4 ะฟัะฝะบัะฐะผะธ:

- ะะฐะผะตัะฐ (ัะพัะพ)
- ะะฐะปะตัะตั (ัะพัะพ)  
- ะะธะดะตะพ (ัะพะปัะบะพ ะณะฐะปะตัะตั)
- ะคะฐะนะป

## ะฆะตะปะตะฒะพะน UX

ะะฐะผะตะฝะธัั ะฝะฐ **ะพะดะธะฝ ัะฝะธะฒะตััะฐะปัะฝัะน ะฒะธะดะถะตั ะบะฐะผะตัั** ั ะธะบะพะฝะบะพะน ะบะฐะผะตัั:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  [๐]  [๐ท]  [____ัะตะบัั____]  [๐ค/โค]   โ
โ         โ                               โ
โ    ะฃะฝะธะฒะตััะฐะปัะฝะฐั ะบะฝะพะฟะบะฐ ะบะฐะผะตัั          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**Tap ะฝะฐ ะบะฝะพะฟะบั ะบะฐะผะตัั** -> ะพัะบััะฒะฐะตั bottom sheet:

- "ะกะดะตะปะฐัั ัะพัะพ" - ะพัะบััะฒะฐะตั ะบะฐะผะตัั ะดะปั ัะพัะพ
- "ะะฐะฟะธัะฐัั ะฒะธะดะตะพ" - ะพัะบััะฒะฐะตั ะบะฐะผะตัั ะดะปั ะฒะธะดะตะพ
- "ะัะฑัะฐัั ะธะท ะณะฐะปะตัะตะธ" - ะพัะบััะฒะฐะตั ะณะฐะปะตัะตั ั ัะธะปัััะพะผ (ัะพัะพ + ะฒะธะดะตะพ)

**Long-press ะฝะฐ ะบะฝะพะฟะบั ะบะฐะผะตัั** -> ััะฐะทั ะพัะบััะฒะฐะตั ะบะฐะผะตัั ะดะปั ะทะฐะฟะธัะธ ะฒะธะดะตะพ (ะฑัััััะน ะดะพัััะฟ)

## ะะทะผะตะฝะตะฝะธั

### 1. ะกะพะทะดะฐัั ะฝะพะฒัะน ะฒะธะดะถะตั `CameraButton`

ะะพะฒัะน ัะฐะนะป: `lib/presentation/widgets/camera_button.dart`

```dart
class CameraButton extends StatelessWidget {
  final VoidCallback onTakePhoto;
  final VoidCallback onRecordVideo;
  final VoidCallback onPickFromGallery;
  
  // Tap -> ะฟะพะบะฐะทะฐัั bottom sheet ั ะพะฟัะธัะผะธ
  // Long-press -> ััะฐะทั ะทะฐะฟะธัะฐัั ะฒะธะดะตะพ
}
```

### 2. ะะฑะฝะพะฒะธัั `message_input.dart`

- ะะฐะผะตะฝะธัั `PopupMenuButton` ะฝะฐ ะดะฒะฐ ะพัะดะตะปัะฝัั ะฒะธะดะถะตัะฐ:
  - `CameraButton` - ะดะปั ัะพัะพ/ะฒะธะดะตะพ
  - ะัะพััะฐั ะบะฝะพะฟะบะฐ ะดะปั ัะฐะนะปะพะฒ (ะตัะปะธ ะฝัะถะฝะฐ)

- ะะพะฑะฐะฒะธัั ะผะตัะพะดั:
  - `_recordVideoFromCamera()` - ะทะฐะฟะธัะฐัั ะฒะธะดะตะพ ั ะบะฐะผะตัั
  - `_pickMediaFromGallery()` - ะฒัะฑัะฐัั ัะพัะพ ะะะ ะฒะธะดะตะพ ะธะท ะณะฐะปะตัะตะธ

### 3. ะะฑะฝะพะฒะธัั `_pickVideo()` 

ะะพะฑะฐะฒะธัั ะฟะพะดะดะตัะถะบั `ImageSource.camera` ะดะปั ะทะฐะฟะธัะธ ะฒะธะดะตะพ:

```dart
Future<void> _recordVideoFromCamera() async {
  final video = await _imagePicker.pickVideo(
    source: ImageSource.camera,
    maxDuration: const Duration(minutes: 5),
  );
  // ... ัะถะฐัะธะต ะธ ะพัะฟัะฐะฒะบะฐ
}
```

### 4. ะะพะฑะฐะฒะธัั ัะฝะธะฒะตััะฐะปัะฝัะน ะฒัะฑะพั ะธะท ะณะฐะปะตัะตะธ

ะัะฟะพะปัะทะพะฒะฐัั `image_picker` ะธะปะธ `file_picker` ะดะปั ะฒัะฑะพัะฐ ะธ ัะพัะพ, ะธ ะฒะธะดะตะพ ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ะธะท ะณะฐะปะตัะตะธ.

## ะกัััะบัััะฐ UI (Bottom Sheet)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        ะะตะดะธะฐ                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ๐ท  ะกะดะตะปะฐัั ัะพัะพ               โ
โ  ๐ฌ  ะะฐะฟะธัะฐัั ะฒะธะดะตะพ             โ
โ  ๐ผ๏ธ  ะัะฑัะฐัั ะธะท ะณะฐะปะตัะตะธ         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะะฐััะฐะณะธะฒะฐะตะผัะต ัะฐะนะปั

- `lib/presentation/widgets/message_input.dart` - ะพัะฝะพะฒะฝัะต ะธะทะผะตะฝะตะฝะธั
- ะะพะฒัะน: `lib/presentation/widgets/camera_button.dart` (ะพะฟัะธะพะฝะฐะปัะฝะพ, ะผะพะถะฝะพ ะฒัััะพะธัั ะฒ message_input)