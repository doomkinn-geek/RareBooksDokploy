# –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Ä–µ–¥–∫–∏—Ö –∫–Ω–∏–≥–∞—Ö —á–µ—Ä–µ–∑ Telegram

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –∫–Ω–∏–≥ –Ω–∞ —Ç–æ—Ä–≥–∞—Ö —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ @RareBooksReminderBot.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### UserNotificationPreference
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ü–µ–Ω–æ–≤—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã
- –ß–∞—Å—Ç–æ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ (Email/Telegram)

#### BookNotification  
- –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- –°–≤—è–∑—å —Å –∫–Ω–∏–≥–æ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### ApplicationUser (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è TelegramId –∏ TelegramUsername

### 2. –°–µ—Ä–≤–∏—Å—ã

#### TelegramNotificationService
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ Telegram Bot API
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫–Ω–∏–≥–∞—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–æ—Ç—É

#### BookNotificationService
- –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏

#### NotificationBackgroundService
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
- –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫

### 3. API –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã

#### NotificationController
–ú–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏:

- `GET /api/notification/preferences` - –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `POST /api/notification/preferences` - –°–æ–∑–¥–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `PUT /api/notification/preferences/{id}` - –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `DELETE /api/notification/preferences/{id}` - –£–¥–∞–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `GET /api/notification/history` - –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `POST /api/notification/telegram/connect` - –°–≤—è–∑–∞—Ç—å —Å Telegram
- `POST /api/notification/telegram/disconnect` - –û—Ç–≤—è–∑–∞—Ç—å –æ—Ç Telegram
- `GET /api/notification/telegram/status` - –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `POST /api/notification/test` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å BookUpdateService

–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è "ProcessBookNotificationsAsync" –≤ —Ü–µ–ø–æ—á–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –∫–Ω–∏–≥–∞—Ö.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### appsettings.json
```json
{
  "TelegramBot": {
    "Token": "7745135732:AAFp2cJs8boBZZDyb1myO1kcmjwk6K3Mi7U"
  }
}
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–¢—Ä–µ–±—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü:
- UserNotificationPreferences
- BookNotifications
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã AspNetUsers (TelegramId, TelegramUsername)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

1. **–°–≤—è–∑–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç —Å Telegram:**
   - –ù–∞–π—Ç–∏ –±–æ—Ç–∞ @RareBooksReminderBot
   - –ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π Telegram ID
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –¥–ª—è —Å–≤—è–∑–∏ –∞–∫–∫–∞—É–Ω—Ç–∞

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞:**
   - –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ü—É—à–∫–∏–Ω", "–ø—Ä–∏–∂–∏–∑–Ω–µ–Ω–Ω–æ–µ –∏–∑–¥–∞–Ω–∏–µ")  
   - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–Ω–∏–≥
   - –¶–µ–Ω–æ–≤—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã (–º–∏–Ω/–º–∞–∫—Å)
   - –ì–æ–¥—ã –∏–∑–¥–∞–Ω–∏—è (–º–∏–Ω/–º–∞–∫—Å)
   - –ì–æ—Ä–æ–¥–∞
   - –ß–∞—Å—Ç–æ—Ç–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–≤ –º–∏–Ω—É—Ç–∞—Ö)

3. **–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–Ω–∏–≥
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —á–∞—Å—Ç–æ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
   - –°—Å—ã–ª–∫–∞ –Ω–∞ –ª–æ—Ç –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏

### –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
```
üìö –ù–∞–π–¥–µ–Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∫–Ω–∏–≥–∞!

–ù–∞–∑–≤–∞–Ω–∏–µ: –ê.–°. –ü—É—à–∫–∏–Ω. –ü–æ–ª–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ —Å–æ—á–∏–Ω–µ–Ω–∏–π
–û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–∏–∂–∏–∑–Ω–µ–Ω–Ω–æ–µ –∏–∑–¥–∞–Ω–∏–µ 1837 –≥–æ–¥–∞...
–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: 15000 ‚ÇΩ
–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è: 1837
–ì–æ—Ä–æ–¥: –ú–æ—Å–∫–≤–∞
–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–æ—Ä–≥–æ–≤: 25.12.2024 18:00
–°–æ–≤–ø–∞–¥–µ–Ω–∏—è: –ü—É—à–∫–∏–Ω, –ø—Ä–∏–∂–∏–∑–Ω–µ–Ω–Ω–æ–µ –∏–∑–¥–∞–Ω–∏–µ

üîó –ü–µ—Ä–µ–π—Ç–∏ –∫ –ª–æ—Ç—É
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –∫–Ω–∏–≥–µ, —Å—Ç–∞—Ç—É—Å—É
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤ –∏—Å—Ç–æ—Ä–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∑–∞ —Ä–∞–∑

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å  
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- Graceful handling –æ—à–∏–±–æ–∫ Telegram API

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram ID —á–µ—Ä–µ–∑ API
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω—ã
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –¥–ª–∏–Ω—É –ø–æ–ª–µ–π –≤ DTO

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –£—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–∫–∞—Ö
- –û—à–∏–±–∫–∞—Ö Telegram API
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –¥—Ä—É–≥–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏:
- Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≥–æ—Ç–æ–≤)
- SMS —á–µ—Ä–µ–∑ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
