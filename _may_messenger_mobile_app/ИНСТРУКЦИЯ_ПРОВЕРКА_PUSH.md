# üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–Ø –¥–æ–±–∞–≤–∏–ª –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ `AppDelegate.swift`, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∫–∞–∂–¥—ã–π —à–∞–≥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

### –¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å:

```
üî• Initializing Firebase...
‚úÖ Firebase initialized successfully
‚úÖ UNUserNotificationCenter delegate set
üì± Requesting notification permissions...
‚úÖ Push notification permission GRANTED (–∏–ª–∏ DENIED)
üì± Registering for remote notifications...
‚úÖ Firebase Messaging delegate set

... –∑–∞—Ç–µ–º ...

‚úÖ APNs token received: [—Ç–æ–∫–µ–Ω]
‚úÖ APNs token passed to Firebase Messaging

... –∏ –Ω–∞–∫–æ–Ω–µ—Ü ...

‚úÖ FCM registration token received: [—Ç–æ–∫–µ–Ω]
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üéâ PUSH NOTIFICATIONS ARE READY!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

---

## üöÄ –°–µ–π—á–∞—Å –≤—ã–ø–æ–ª–Ω–∏—Ç–µ

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd /Users/janaplett/RareBooksDokploy/_may_messenger_mobile_app

flutter run --release
```

**–ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª!** –õ–æ–≥–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ç–∞–º.

---

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

**–ò—â–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:**

#### ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Å–ª—É—á–∞–π:

```
üî• Initializing Firebase...
‚úÖ Firebase initialized successfully
‚úÖ UNUserNotificationCenter delegate set
üì± Requesting notification permissions...
‚úÖ Push notification permission GRANTED
üì± Registering for remote notifications...
‚úÖ Firebase Messaging delegate set
‚úÖ APNs token received: [–¥–ª–∏–Ω–Ω—ã–π_—Ç–æ–∫–µ–Ω]
‚úÖ APNs token passed to Firebase Messaging
‚úÖ FCM registration token received: [—Ç–æ–∫–µ–Ω]
üéâ PUSH NOTIFICATIONS ARE READY!
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –†–ê–ë–û–¢–ê–Æ–¢!** üéâ

---

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–µ –¥–∞–Ω–æ

```
‚ùå Push notification permission DENIED by user
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–¥–∞–ª–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å iPhone
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ iPhone ‚Üí –û—Å–Ω–æ–≤–Ω—ã–µ ‚Üí –°–±—Ä–æ—Å ‚Üí –°–±—Ä–æ—Å–∏—Ç—å –≥–µ–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å
3. –ò–ª–∏ –≤—Ä—É—á–Ω—É—é: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ iPhone ‚Üí –î–µ–ø–µ—à–∞ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí –≤–∫–ª—é—á–∏—Ç–µ

---

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ APNs

```
‚ùå Failed to register for remote notifications: [–æ—à–∏–±–∫–∞]
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- Entitlements –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- Push Notifications capability –Ω–µ –≤–∫–ª—é—á–µ–Ω
- Provisioning Profile –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ (APNs –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ!)

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Xcode: `open ios/Runner.xcworkspace`
2. Runner ‚Üí Signing & Capabilities
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Push Notifications –≤–∫–ª—é—á–µ–Ω
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Background Modes ‚Üí Remote notifications –≤–∫–ª—é—á–µ–Ω
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º iPhone, –Ω–µ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ!

---

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 3: APNs —Ç–æ–∫–µ–Ω –µ—Å—Ç—å, –Ω–æ FCM —Ç–æ–∫–µ–Ω–∞ –Ω–µ—Ç

```
‚úÖ APNs token received: [—Ç–æ–∫–µ–Ω]
‚úÖ APNs token passed to Firebase Messaging
... –Ω–æ –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–∞ ...
```

–∏–ª–∏

```
‚ùå FCM token is nil!
‚ö†Ô∏è  Check Firebase Console APNs key configuration
```

**–ü—Ä–∏—á–∏–Ω–∞:** Firebase –Ω–µ –º–æ–∂–µ—Ç –æ–±–º–µ–Ω—è—Ç—å APNs —Ç–æ–∫–µ–Ω –Ω–∞ FCM —Ç–æ–∫–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Firebase Console: https://console.firebase.google.com/project/maymessenger-3fdf0
2. Project settings ‚Üí Cloud Messaging
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "Apple app configuration"
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ **Production APNs auth key** –∑–∞–≥—Ä—É–∂–µ–Ω:
   - Key ID: `57HSVMW9B9`
   - Team ID: `DM754J3JJS`
5. –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
6. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç
7. –£–¥–∞–ª–∏—Ç–µ –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## üìã –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–æ–≤

### –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç (–≤–∏–¥–∏—Ç–µ –æ–±–∞ —Ç–æ–∫–µ–Ω–∞):

1. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:**

```
üåê https://console.firebase.google.com/project/maymessenger-3fdf0

Engage ‚Üí Messaging ‚Üí New campaign
‚Üí Firebase Notification messages
‚Üí Title: –¢–µ—Å—Ç
‚Üí Next
‚Üí App: –î–µ–ø–µ—à–∞ (iOS)
‚Üí Publish
```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ iPhone** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏!

---

### –ï—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—Ç–µ –ª–æ–≥–æ–≤ –≤–æ–æ–±—â–µ:

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å –∏–ª–∏ –ª–æ–≥–∏ –Ω–µ –≤—ã–≤–æ–¥—è—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ iPhone –ø–æ–¥–∫–ª—é—á–µ–Ω:
   ```bash
   flutter devices
   ```
   –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –≤–∞—à iPhone.

2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏:
   ```bash
   flutter run --release --verbose
   ```

3. –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ Xcode –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Ç–∞–º:
   ```bash
   open ios/Runner.xcworkspace
   ```
   –ù–∞–∂–º–∏—Ç–µ ‚ñ∂Ô∏è Run –≤ Xcode –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –Ω–∏–∂–Ω–µ–π –ø–∞–Ω–µ–ª–∏.

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞ iPhone

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ iPhone** ‚Üí **–î–µ–ø–µ—à–∞**
2. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **–í–∫–ª—é—á–µ–Ω–æ**
3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - ‚úÖ –†–∞–∑—Ä–µ—à–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - ‚úÖ –ë–∞–Ω–Ω–µ—Ä—ã
   - ‚úÖ –ó–≤—É–∫–∏
   - ‚úÖ –ë–µ–π–¥–∂–∏

–ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ - –≤–∫–ª—é—á–∏—Ç–µ –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

---

## üìä –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –õ–æ–≥–∏ | –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|------|----------------|----------|
| ‚úÖ –û–±–∞ —Ç–æ–∫–µ–Ω–∞ (APNs + FCM) | –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! | –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç –∏–∑ Firebase Console |
| ‚úÖ –¢–æ–ª—å–∫–æ APNs, –Ω–µ—Ç FCM | APNs –∫–ª—é—á –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Firebase | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Firebase Console ‚Üí Cloud Messaging |
| ‚ùå Permission DENIED | –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–µ –¥–∞–Ω–æ | –£–¥–∞–ª–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ |
| ‚ùå Registration failed | –ü—Ä–æ–±–ª–µ–º–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ Xcode | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ capabilities –≤ Xcode |
| ü§∑ –ù–µ—Ç –ª–æ–≥–æ–≤ | –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `flutter devices`, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ Xcode |

---

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ backend

–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –∞ –≤ —Ç–æ–º, –∫–∞–∫ backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è iOS:**

```json
{
  "message": {
    "token": "FCM_TOKEN",
    "notification": {
      "title": "–¢–µ—Å—Ç",
      "body": "–ü—Ä–æ–≤–µ—Ä–∫–∞"
    },
    "apns": {
      "payload": {
        "aps": {
          "alert": {
            "title": "–¢–µ—Å—Ç",
            "body": "–ü—Ä–æ–≤–µ—Ä–∫–∞"
          },
          "sound": "default",
          "badge": 1,
          "content-available": 1
        }
      }
    }
  }
}
```

**‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è iOS:**
- `"content-available": 1` - –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°–µ–∫—Ü–∏—è `"apns"` —Å –ø–æ–ª–Ω—ã–º `"aps"` payload

---

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Bundle ID

–í Firebase Console –∏ –≤ Xcode –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π:
```
com.maymessenger.mobileApp
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- Firebase: Project settings ‚Üí General ‚Üí iOS apps
- Xcode: Runner ‚Üí General ‚Üí Bundle Identifier

---

### 3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–¥–∞–ª–∏—Ç—å –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å iOS app –≤ Firebase

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:
1. Firebase Console ‚Üí Project settings ‚Üí General
2. –ù–∞–π–¥–∏—Ç–µ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–î–µ–ø–µ—à–∞"
3. –£–¥–∞–ª–∏—Ç–µ –µ–≥–æ
4. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ —Å —Ç–µ–º –∂–µ Bundle ID
5. –°–∫–∞—á–∞–π—Ç–µ –Ω–æ–≤—ã–π GoogleService-Info.plist
6. –ó–∞–º–µ–Ω–∏—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ
7. –ó–∞–≥—Ä—É–∑–∏—Ç–µ APNs –∫–ª—é—á –∑–∞–Ω–æ–≤–æ
8. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## üìû –ù–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `flutter run --release` **—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ –ª–æ–≥–∏ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞** –∏ –ø–æ–∫–∞–∂–∏—Ç–µ –º–Ω–µ.

–û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω—ã —Å—Ç—Ä–æ–∫–∏ —Å:
- üî• Firebase
- ‚úÖ –∏–ª–∏ ‚ùå
- APNs token
- FCM token

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ–±–ª–µ–º–∞!

---

**–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏!** üöÄ

```bash
cd /Users/janaplett/RareBooksDokploy/_may_messenger_mobile_app
flutter run --release
```
