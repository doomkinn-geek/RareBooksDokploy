# –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Let's Encrypt –¥–ª—è –¥–æ–º–µ–Ω–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ RareBooks.

---

## üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

### –°–∫—Ä–∏–ø—Ç—ã
| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `get_messenger_certificate.sh` | –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –¥–ª—è messenger.rare-books.ru |
| `renew_all_certificates.sh` | –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ cron) |
| `pre_certificate_check.sh` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–¥ –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ |
| `check_certificates.sh` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º—ã |

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `QUICK_START.md` | –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (5 –º–∏–Ω—É—Ç) ‚ö° |
| `CERTIFICATE_SETUP_INSTRUCTIONS.md` | –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ –≤—Å–µ–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –∏ troubleshooting üìö |
| `COMMANDS_CHEATSHEET.md` | –®–ø–∞—Ä–≥–∞–ª–∫–∞ —Å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ üìù |
| `README.md` | –≠—Ç–æ—Ç —Ñ–∞–π–ª - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫—Ä–∏–ø—Ç–∞—Ö |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x scripts/pre_certificate_check.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É
sudo scripts/pre_certificate_check.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Certbot
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ª–∏ DNS –∑–∞–ø–∏—Å–∏
- ‚úÖ –ó–∞–ø—É—â–µ–Ω –ª–∏ nginx
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã –ª–∏ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã
- ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω –ª–∏ challenge endpoint

### –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x scripts/get_messenger_certificate.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
sudo scripts/get_messenger_certificate.sh
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ nginx

```bash
docker-compose restart proxy
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x scripts/check_certificates.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
sudo scripts/check_certificates.sh
```

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ `QUICK_START.md`**

---

## üîÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# 1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—É—Ç—å –≤ —Å–∫—Ä–∏–ø—Ç–µ
nano scripts/renew_all_certificates.sh
# –ò–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É

# 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Å–∏—Å—Ç–µ–º—É
sudo cp scripts/renew_all_certificates.sh /usr/local/bin/
sudo chmod +x /usr/local/bin/renew_all_certificates.sh

# 3. –î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞—á—É –≤ cron
sudo crontab -e
# –î–æ–±–∞–≤—å—Ç–µ: 0 3 * * * /usr/local/bin/renew_all_certificates.sh >> /var/log/renew_cert.log 2>&1
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
‚Üí –ß–∏—Ç–∞–π—Ç–µ `QUICK_START.md` (5 –º–∏–Ω—É—Ç)

### –î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è
‚Üí –ß–∏—Ç–∞–π—Ç–µ `CERTIFICATE_SETUP_INSTRUCTIONS.md` (–ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)

### –î–ª—è —Å–ø—Ä–∞–≤–∫–∏ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
‚Üí –ß–∏—Ç–∞–π—Ç–µ `COMMANDS_CHEATSHEET.md` (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

### 1. pre_certificate_check.sh - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É Certbot
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç DNS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å nginx –∏ –ø–æ—Ä—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–æ–≤ Docker
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç challenge endpoint
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
chmod +x scripts/pre_certificate_check.sh
sudo scripts/pre_certificate_check.sh
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚úÖ –ü—Ä–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 2. get_messenger_certificate.sh - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É –¥–ª—è challenge-—Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –ó–∞–ø—É—Å–∫–∞–µ—Ç Certbot –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- –í—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
chmod +x scripts/get_messenger_certificate.sh
sudo scripts/get_messenger_certificate.sh
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –î–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚úÖ –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚ö†Ô∏è –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –ø–æ–º–æ—â—å—é pre_certificate_check.sh

### 3. check_certificates.sh - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞ –¥–∏—Å–∫–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —á–µ—Ä–µ–∑ —Å–µ—Ç—å
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å Certbot –∏ cron –∑–∞–¥–∞—á
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –í—ã–≤–æ–¥–∏—Ç —Ü–≤–µ—Ç–Ω–æ–π –æ—Ç—á–µ—Ç

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
chmod +x scripts/check_certificates.sh
sudo scripts/check_certificates.sh
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚úÖ –î–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –ü—Ä–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –ø—Ä–æ–±–ª–µ–º —Å HTTPS
- ‚úÖ –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 4. renew_all_certificates.sh - –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —á–µ—Ä–µ–∑ Certbot
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç nginx –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ª–æ–≥–∏ –≤ /var/log/renew_cert.log

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
# 1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –≤ —Å–∫—Ä–∏–ø—Ç–µ
nano scripts/renew_all_certificates.sh

# 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
sudo cp scripts/renew_all_certificates.sh /usr/local/bin/
sudo chmod +x /usr/local/bin/renew_all_certificates.sh

# 3. –î–æ–±–∞–≤—å—Ç–µ –≤ cron
sudo crontab -e
# –î–æ–±–∞–≤—å—Ç–µ: 0 3 * * * /usr/local/bin/renew_all_certificates.sh >> /var/log/renew_cert.log 2>&1
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
sudo /usr/local/bin/renew_all_certificates.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–∞
cat /var/log/renew_cert.log
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ cron
- ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üîß –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **Certbot** - –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Let's Encrypt
- **Docker Compose** - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- **Nginx** - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ reverse proxy
- **Cron** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

---

## üìã –î–æ–º–µ–Ω—ã –ø—Ä–æ–µ–∫—Ç–∞

| –î–æ–º–µ–Ω | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç |
|-------|-----------|-----------|
| `rare-books.ru` | –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ RareBooks | `/etc/letsencrypt/live/rare-books.ru/` |
| `www.rare-books.ru` | Alias –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ | (—Ç–æ—Ç –∂–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç) |
| `messenger.rare-books.ru` | API –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ MayMessenger | `/etc/letsencrypt/live/messenger.rare-books.ru/` |

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–†–∞–∑–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤**
   - –ö–∞–∂–¥—ã–π –¥–æ–º–µ–Ω/–ø–æ–¥–¥–æ–º–µ–Ω –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
   - –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç `rare-books.ru` –¥–ª—è `messenger.rare-books.ru`

2. **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**
   - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Let's Encrypt –¥–µ–π—Å—Ç–≤—É—é—Ç 90 –¥–Ω–µ–π
   - Certbot –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞ 30 –¥–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
   - Cron –∑–∞–¥–∞—á–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00

3. **DNS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
   - –ü–µ—Ä–µ–¥ –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DNS –∑–∞–ø–∏—Å—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `nslookup messenger.rare-books.ru`

4. **Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ `nginx/nginx_prod.conf`
   - –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å nginx: `docker-compose restart proxy`

5. **–ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤**
   - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ —Ö–æ—Å—Ç–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ `docker-compose.yml`
   - –ü—É—Ç—å: `/etc/letsencrypt:/etc/letsencrypt:ro`

---

## üêõ Troubleshooting

### –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è
```bash
docker-compose restart proxy
```

### –û—à–∏–±–∫–∞ "DNS problem: NXDOMAIN"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS
nslookup messenger.rare-books.ru
# –ü–æ–¥–æ–∂–¥–∏—Ç–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è DNS (5-30 –º–∏–Ω—É—Ç)
```

### –û—à–∏–±–∫–∞ "Connection refused"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ nginx –∑–∞–ø—É—â–µ–Ω
docker ps | grep nginx

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker logs nginx_container
```

### –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é nginx
docker exec nginx_container cat /etc/nginx/nginx.conf | grep -A5 "messenger.rare-books.ru"

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# ssl_certificate     /etc/letsencrypt/live/messenger.rare-books.ru/fullchain.pem;
# ssl_certificate_key /etc/letsencrypt/live/messenger.rare-books.ru/privkey.pem;
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ `CERTIFICATE_SETUP_INSTRUCTIONS.md`

---

## üìû –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
sudo certbot certificates

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (dry-run)
sudo certbot renew --dry-run

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ nginx
docker logs nginx_container -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–æ–º–µ–Ω–∞
curl -I https://messenger.rare-books.ru/health

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
cat /var/log/renew_cert.log
```

---

## üéØ Checklist –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] DNS –∑–∞–ø–∏—Å—å –¥–ª—è messenger.rare-books.ru –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] Nginx –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 80/443
- [ ] –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è messenger.rare-books.ru –ø–æ–ª—É—á–µ–Ω
- [ ] Nginx –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- [ ] https://messenger.rare-books.ru/swagger –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ cron
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2024-12  
**–ü—Ä–æ–µ–∫—Ç:** RareBooks + MayMessenger

